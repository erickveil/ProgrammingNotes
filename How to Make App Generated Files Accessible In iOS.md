---
title: How to Make App Generated Files Accessible In iOS
layout: note
tags:
  - iOS
  - swift
  - Qt6
---

# Problem

I've written an iOS app in qt. This app writes a log to a txt file it creates in `QStandardPaths::DocumentsLocation`
I'd like to be able to get the log off of the iPad.

# Accessing Via XCode

You can make the log file accessible from the "Devices and Simulators" window in Xcode, but you need to configure your iOS app to enable file sharing. This way, the log file (or any other files in the app's Documents directory) can be accessed via the "Installed Apps" list, allowing you to download it from Xcode. Here's how to set it up:

1. **Enable File Sharing in your App:**
   You need to modify your app's `Info.plist` file to allow file sharing, so files in the app's Documents directory (such as your log file) are accessible.

   - In Xcode, open your app’s `Info.plist` file.
   - Add a new key called **`UIFileSharingEnabled`**.
   - Set its value to **`YES`**.

2. **Build and Run the App:**
   Once you have set the `UIFileSharingEnabled` key, build and run your app on your iPad.

3. **Access the File via Xcode:**
   After running the app:
   - In Xcode, go to `Window -> Devices and Simulators`.
   - Select your iPad in the list of devices.
   - Under the "Installed Apps" section, you will see your app.
   - Click on the **gear icon** next to your app, and select **Download Container**.

   This will download the entire app container (including its Documents directory) to your Mac. You can then browse the container, extract the log file from the `Documents` folder, and view or process it.

# Using Qt to Add Values to the PList

You can add entries to the `Info.plist` file generated by Qt through your `.pro` file by defining `QMAKE_INFO_PLIST` or using the `ios` scope in the `.pro` file to modify specific properties.

To enable file sharing, you need to add the `UIFileSharingEnabled` key to the `Info.plist`. Here's how you can do it:

1. **Create a Custom `Info.plist` Fragment:**

   You can create a custom `Info.plist` fragment that will be merged with the one generated by Qt.

   Create a file called `Info_plist_additions.plist` with the following content:

   ```xml
   <?xml version="1.0" encoding="UTF-8"?>
   <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
   <plist version="1.0">
   <dict>
       <key>UIFileSharingEnabled</key>
       <true/>
   </dict>
   </plist>
   ```

2. **Include the Custom `Info.plist` Fragment in Your `.pro` File:**

   In your `.pro` file, you can tell qmake to include this custom `Info.plist` fragment when generating the final `Info.plist`:

   ```qmake
   ios {
       QMAKE_INFO_PLIST = $$PWD/Info_plist_additions.plist
   }
   ```

   Alternatively, if you don't want to create a separate file, you can directly append to the `Info.plist` in your `.pro` file like this:

   ```qmake
   ios {
       QMAKE_MAC_XCODE_INFO_PLIST_EXTRA += "<key>UIFileSharingEnabled</key><true/>"
   }
   ```


# Accessing Files From the Files App

To make your app’s documents accessible from the **Files** app on iOS, you need to enable **iTunes file sharing** (which we already discussed) and enable the **LSSupportsOpeningDocumentsInPlace** key in your app’s `Info.plist`. This allows files in your app’s Documents directory to be managed and opened in-place using the Files app.

Here’s what you need to do in your `.pro` file to enable both file sharing and Files app access:

### 1. **Enable File Sharing and Open-In-Place Access:**

You need to add two keys to your `Info.plist`:

- **`UIFileSharingEnabled`**: This allows iTunes (and Xcode) file sharing, enabling access to the Documents directory.
- **`LSSupportsOpeningDocumentsInPlace`**: This makes the documents accessible via the Files app and allows in-place editing.

### 2. **Add the Configuration in Your `.pro` File:**

You can modify your `.pro` file to append these keys to the `Info.plist` generated by Qt.

#### Option 1: Using an External `Info.plist` Fragment

Create a file called `Info_plist_additions.plist` with the following content:

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>UIFileSharingEnabled</key>
    <true/>
    <key>LSSupportsOpeningDocumentsInPlace</key>
    <true/>
</dict>
</plist>
```

Then, in your `.pro` file:

```qmake
ios {
    QMAKE_INFO_PLIST = $$PWD/Info_plist_additions.plist
}
```

#### Option 2: Directly in the `.pro` File

If you prefer to avoid an external file and just use the `.pro` file directly, you can append the necessary keys to the `Info.plist` like this:

```qmake
ios {
    QMAKE_MAC_XCODE_INFO_PLIST_EXTRA += "<key>UIFileSharingEnabled</key><true/>"
    QMAKE_MAC_XCODE_INFO_PLIST_EXTRA += "<key>LSSupportsOpeningDocumentsInPlace</key><true/>"
}
```

### 3. **Ensure Your Files Are Saved in the Correct Directory:**

To ensure your files are accessible from the Files app, they need to be saved in the **Documents** directory (which is the standard location for file sharing):

```cpp
QString documentsPath = QStandardPaths::writableLocation(QStandardPaths::DocumentsLocation);
// Save the log file in this directory
```

By doing this, your log file and other files saved to the `Documents` directory will be accessible from the Files app, and they can be shared, opened, and edited in place.

This should give you full access to your app’s files from both iTunes/Xcode and the iOS Files app.

# No Special Permissions Required to Write in the Right Location

You don't need to add a specific setting in the `Info.plist` file to allow your app to write files to its **Documents** directory. iOS apps are sandboxed, and they automatically have permission to read and write files within their own sandbox, which includes directories such as:

- `Documents`
- `Caches`
- `tmp`

These are the writable locations provided by iOS for app-specific data. As long as you're writing files to the `Documents` directory (or the `Caches` directory for non-essential data), your app will have permission to write without any additional `Info.plist` configuration.

The key points are:

1. **Documents Directory**: Use this directory for user-generated files or files that the user might want to back up or access from the Files app. Files here are backed up to iCloud unless you specifically mark them as not to be backed up.

2. **Caches Directory**: Use this directory for temporary files that your app can re-create if needed. Files here are not backed up to iCloud, and the system may delete them when storage is low.

3. **Temporary Directory (tmp)**: Use this for truly temporary files that you don't expect to keep around after the app session. Files here can be deleted at any time by the system.

### Example of Writing to the Documents Directory in Qt

You can write to the Documents directory like this:

```cpp
QString documentsPath = QStandardPaths::writableLocation(QStandardPaths::DocumentsLocation);
QFile logFile(documentsPath + "/log.txt");

if (logFile.open(QIODevice::WriteOnly | QIODevice::Text)) {
    QTextStream out(&logFile);
    out << "This is a log entry\n";
    logFile.close();
}
```

